<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <meta name="theme-color" content="#ffffff" />
    <meta
      http-equiv="Cache-Control"
      content="no-cache, no-store, must-revalidate"
    />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <title>Навыки</title>
    <link rel="manifest" href="manifest.json" />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="icons/icon-192x192.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="icons/icon-192x192.png"
    />
    <link rel="shortcut icon" href="icons/icon-192x192.png" />
    <link rel="apple-touch-icon" href="icons/icon-192x192.png" />
    <link rel="stylesheet" href="fonts/remixicon/remixicon.css" />
    <link rel="stylesheet" href="styles/main.css?v=1.8.2" />
    <link rel="stylesheet" href="styles/diary.css?v=1.8.2" />
    <link rel="stylesheet" href="styles/fireworks.css" />
    <link rel="stylesheet" href="styles/theory.css" />
  </head>
  <body>
    <header class="glass-header">
      <h1 class="app-title">А вдруг это работает?</h1>
    </header>
    <nav class="main-nav">
      <ul>
        <li>
          <a href="#theory" class="active">
            <i class="ri-book-read-line"></i>
            <span>Теория</span>
          </a>
        </li>
        <li>
          <a href="#practice">
            <i class="ri-compass-3-line"></i>
            <span>Практика</span>
          </a>
        </li>
        <li>
          <a href="#diary">
            <i class="ri-draft-line"></i>
            <span>Дневник</span>
          </a>
        </li>
        <li>
          <a href="#settings">
            <i class="ri-settings-4-line"></i>
            <span>Настройка</span>
          </a>
        </li>
      </ul>
    </nav>

    <main>
      <section id="theory" class="page active">
        <h1>Теория ДПТ</h1>
        <button id="installButton" class="install-button">
          <svg class="install-icon" viewBox="0 0 24 24" width="24" height="24">
            <path
              fill="currentColor"
              d="M13 5v6h1.17L12 13.17 9.83 11H11V5h2m2-2H9v6H5l7 7 7-7h-4V3zm4 15H5v2h14v-2z"
            />
          </svg>
          Установить приложение
        </button>

        <div class="assumption-card">
          <div class="assumption-header">
            <button
              class="refresh-button"
              aria-label="Показать следующее допущение"
            >
              <i class="ri-refresh-line"></i>
            </button>
          </div>
          <div class="assumption-title">
            Все люди хотят чувствовать себя лучше
          </div>
          <div class="assumption-text">
            Общая для всех людей характеристика – то, что люди хотят улучшать
            свои жизни и быть счастливыми
          </div>
        </div>

        <button class="theory-toggle-button" id="emotionalScaleToggle">
          <i class="ri-question-line"></i>
          <span>Интенсивность эмоций и навыки</span>
        </button>

        <div class="emotional-scale" id="emotionalScale" style="display: none">
          <div class="scale-row">
            <div class="intensity-level level-1-2">1-2</div>
            <i class="ri-arrow-right-line arrow-icon"></i>
            <div class="skill-label">Осознанность</div>
          </div>

          <div class="scale-row">
            <div class="intensity-level level-3-6">3-6</div>
            <i class="ri-arrow-right-line arrow-icon"></i>
            <div class="skill-label">Эмоциональная регуляция</div>
          </div>

          <div class="scale-row">
            <div class="intensity-level level-7-10">7-10</div>
            <i class="ri-arrow-right-line arrow-icon"></i>
            <div class="skill-label">Стрессоустойчивость</div>
          </div>
        </div>

        <div id="skillsContainer"></div>
        <div class="blocks-container"></div>
      </section>

      <section id="practice" class="page">
        <h1>Практика</h1>
        <div class="date-card-wrapper">
          <div class="behavior-card date-card">
            <div class="date-buttons">
              <!-- Кнопки с датами будут добавлены через JavaScript -->
            </div>
          </div>
        </div>
        <div class="skills-blocks">
          <!-- Блоки навыков будут добавлены через JavaScript -->
        </div>
      </section>

      <section id="diary" class="page">
        <h1>Дневник</h1>
        <div class="diary-actions">
          <div class="primary-actions">
            <button class="ios-action-button" id="fillDiaryBtn">
              <span class="ios-button-icon"><i class="ri-edit-line"></i></span>
              <span class="ios-button-label">Заполнить дневник</span>
            </button>
            <button class="ios-action-button" id="addBehaviorBtn">
              <span class="ios-button-icon">+</span>
              <span class="ios-button-label">Поведение</span>
            </button>
          </div>
          <button class="ios-action-button secondary" id="exportScreenshotBtn">
            <span class="ios-button-icon"
              ><i class="ri-file-download-line"></i
            ></span>
            <span class="ios-button-label">Сохранить дневник</span>
          </button>
        </div>
        <div class="behavior-cards"></div>

        <!-- Модальное окно для добавления поведения -->
        <div class="modal" id="addBehaviorModal">
          <div class="modal-content">
            <h2>Добавить проблемное поведение</h2>
            <input
              type="text"
              id="behaviorInput"
              placeholder="Введите название"
              maxlength="100"
            />
            <select id="behaviorType" class="behavior-type-select">
              <option value="boolean">Было/не было</option>
              <option value="scale">Шкала (от нуля до пяти)</option>
              <option value="text">Текст</option>
            </select>
            <div class="behavior-type-hint" id="booleanHint">
              Простой способ отметить, было ли определенное поведение
            </div>
            <div class="behavior-type-hint" id="scaleHint">
              Оценка интенсивности поведения от нуля (отсутствует) до пяти
              (максимально)
            </div>
            <div class="behavior-type-hint" id="textHint">
              Свободное описание ситуации своими словами
            </div>
            <div class="modal-buttons">
              <button class="cancel-button">Отмена</button>
              <button class="save-button">Сохранить</button>
            </div>
          </div>
        </div>

        <!-- Модальное окно для экспорта дневника -->
        <div class="modal" id="exportDiaryModal">
          <div class="modal-content">
            <h2>Сохранение дневника</h2>
            <div class="export-days-control">
              <div class="export-days-input">
                <input
                  type="number"
                  id="exportDays"
                  value="7"
                  min="1"
                  max="14"
                />
                <span>дней</span>
              </div>
            </div>

            <div class="export-format-control">
              <div class="export-format-options">
                <label class="radio-label">
                  <input type="radio" name="exportFormat" value="png" checked />
                  <span class="radio-text">Картинка</span>
                </label>
                <label class="radio-label">
                  <input type="radio" name="exportFormat" value="csv" />
                  <span class="radio-text">Таблица</span>
                </label>
              </div>
            </div>
            <div class="influence-assessment">
              <p class="influence-description">
                Насколько вы можете управлять:
              </p>
              <div class="influence-controls">
                <div class="influence-item">
                  <div class="influence-item-content">
                    <span class="influence-label">Мыслями</span>
                    <div class="scale-buttons">
                      <button
                        class="scale-button diary-button"
                        data-value="0"
                        data-field="thoughts"
                      >
                        0
                      </button>
                      <button
                        class="scale-button diary-button"
                        data-value="1"
                        data-field="thoughts"
                      >
                        1
                      </button>
                      <button
                        class="scale-button diary-button"
                        data-value="2"
                        data-field="thoughts"
                      >
                        2
                      </button>
                      <button
                        class="scale-button diary-button"
                        data-value="3"
                        data-field="thoughts"
                      >
                        3
                      </button>
                      <button
                        class="scale-button diary-button"
                        data-value="4"
                        data-field="thoughts"
                      >
                        4
                      </button>
                      <button
                        class="scale-button diary-button"
                        data-value="5"
                        data-field="thoughts"
                      >
                        5
                      </button>
                    </div>
                  </div>
                </div>
                <div class="influence-item">
                  <div class="influence-item-content">
                    <span class="influence-label">Эмоциями</span>
                    <div class="scale-buttons">
                      <button
                        class="scale-button diary-button"
                        data-value="0"
                        data-field="emotions"
                      >
                        0
                      </button>
                      <button
                        class="scale-button diary-button"
                        data-value="1"
                        data-field="emotions"
                      >
                        1
                      </button>
                      <button
                        class="scale-button diary-button"
                        data-value="2"
                        data-field="emotions"
                      >
                        2
                      </button>
                      <button
                        class="scale-button diary-button"
                        data-value="3"
                        data-field="emotions"
                      >
                        3
                      </button>
                      <button
                        class="scale-button diary-button"
                        data-value="4"
                        data-field="emotions"
                      >
                        4
                      </button>
                      <button
                        class="scale-button diary-button"
                        data-value="5"
                        data-field="emotions"
                      >
                        5
                      </button>
                    </div>
                  </div>
                </div>
                <div class="influence-item">
                  <div class="influence-item-content">
                    <span class="influence-label">Действиями</span>
                    <div class="scale-buttons">
                      <button
                        class="scale-button diary-button"
                        data-value="0"
                        data-field="actions"
                      >
                        0
                      </button>
                      <button
                        class="scale-button diary-button"
                        data-value="1"
                        data-field="actions"
                      >
                        1
                      </button>
                      <button
                        class="scale-button diary-button"
                        data-value="2"
                        data-field="actions"
                      >
                        2
                      </button>
                      <button
                        class="scale-button diary-button"
                        data-value="3"
                        data-field="actions"
                      >
                        3
                      </button>
                      <button
                        class="scale-button diary-button"
                        data-value="4"
                        data-field="actions"
                      >
                        4
                      </button>
                      <button
                        class="scale-button diary-button"
                        data-value="5"
                        data-field="actions"
                      >
                        5
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="modal-buttons">
              <button class="cancel-button">Отмена</button>
              <button class="save-button">Сохранить</button>
            </div>
          </div>
        </div>
      </section>

      <section id="settings" class="page">
        <h1>Настройка</h1>

        <div class="settings-section">
          <h2>Отображение</h2>
          <div class="theme-selector">
            <h3>Тема оформления</h3>
            <div class="theme-options">
              <button class="theme-button" data-theme="system">
                <i class="ri-computer-line"></i>
                <span>Системная</span>
              </button>
              <button class="theme-button" data-theme="light">
                <i class="ri-sun-line"></i>
                <span>Светлая</span>
              </button>
              <button class="theme-button" data-theme="dark">
                <i class="ri-moon-line"></i>
                <span>Темная</span>
              </button>
            </div>
          </div>
          <div class="setting-item">
            <label class="switch-label">
              <span>Показывать допущения</span>
              <label class="switch">
                <input type="checkbox" id="showAssumptions" checked />
                <span class="slider round"></span>
              </label>
            </label>
          </div>
          <div class="setting-item">
            <label class="switch-label">
              <span>Показывать кнопку установки</span>
              <label class="switch">
                <input type="checkbox" id="showInstallButton" checked />
                <span class="slider round"></span>
              </label>
            </label>
          </div>
          <div class="setting-item">
            <label class="switch-label">
              <span>Глаголы в женском роде</span>
              <label class="switch">
                <input type="checkbox" id="preferredGender" checked />
                <span class="slider round"></span>
              </label>
            </label>
          </div>
        </div>

        <div class="settings-section">
          <h2>О приложении</h2>
          <div class="app-info">
            <p>Это приложение разработано с учетом вашей приватности:</p>
            <ul>
              <li>
                Все ваши данные хранятся только локально на вашем устройстве
              </li>
              <li>Приложение работает без подключения к интернету</li>
              <li>Никакие данные не отправляются на сервер</li>
              <li>
                Исходный код приложения опубликован на GitHub и доступен для
                проверки
              </li>
            </ul>
            <div class="warning-box">
              <i class="ri-error-warning-line"></i>
              <span
                >Важно: все данные хранятся локально в браузере. При очистке
                данных браузера ваши записи будут удалены.</span
              >
            </div>
            <p class="version-info">
              Версия приложения: <tt class="version-number"></tt>
            </p>
          </div>
          <div class="about-links">
            <div class="link-item">
              <svg class="link-icon" viewBox="0 0 24 24" width="24" height="24">
                <path
                  fill="currentColor"
                  d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"
                />
              </svg>
              <a
                href="https://github.com/mitenka/skills"
                target="_blank"
                rel="noopener noreferrer"
                class="link-button"
              >
                <span>Исходный код на GitHub</span>
              </a>
            </div>
            <div class="link-item">
              <svg class="link-icon" viewBox="0 0 24 24" width="24" height="24">
                <path
                  fill="currentColor"
                  d="M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"
                />
              </svg>
              <a href="https://t.me/mitenka" target="_blank" rel="noopener"
                >Связаться в Telegram</a
              >
            </div>
          </div>
        </div>

        <div class="settings-section">
          <h2>Опасная зона</h2>
          <div class="setting-item danger-zone">
            <p class="danger-description">
              Это действие удалит все ваши данные из приложения, включая записи
              поведений и настройку. Отменить это действие будет невозможно.
            </p>
            <button id="clearDataBtn" class="danger-button">
              <i class="ri-delete-bin-7-line"></i>
              Удалить все мои данные
            </button>
          </div>
        </div>
      </section>
    </main>
    <!-- Контейнер для воодушевляющего сообщения -->
    <div class="success-message" id="successMessage">
      <div class="success-content">
        <i></i>
        <span class="message-text"></span>
      </div>
    </div>
    <script
      src="https://unpkg.com/dexie@latest/dist/modern/dexie.min.mjs"
      type="module"
    ></script>
    <script src="js/theme.js" type="module"></script>
    <script src="js/app.js" type="module"></script>
    <script src="js/fireworks.js"></script>
    <script type="module" src="js/practice.js"></script>
    <script>
      if ("serviceWorker" in navigator) {
        navigator.serviceWorker
          .register("/service-worker.js")
          .then((registration) => {
            console.log("ServiceWorker registered");

            // Получаем версию из Service Worker
            if (registration.active) {
              const channel = new MessageChannel();
              channel.port1.onmessage = (event) => {
                document.querySelector(".version-number").textContent =
                  event.data;
              };
              registration.active.postMessage("getVersion", [channel.port2]);
            }
          })
          .catch((error) =>
            console.log("ServiceWorker registration failed:", error)
          );
      }
    </script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
  </body>
</html>
